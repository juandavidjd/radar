=== Master pipeline iniciado ===
[INFO] Base:  C:\RadarPremios\radar_premios.db
[INFO] Log:   C:\RadarPremios\logs\master_2025-08-14_083148.log.txt

[STEP] Scraper LOTERÃAS
[CMD ] python -X utf8 "C:\RadarPremios\scripts\scraper_loterias.py"
[2025-08-14 08:31:49] === Inicio de scrapeo de loterías ===
[2025-08-14 08:31:49] [INFO] tolima: sin nuevos registros
[2025-08-14 08:31:49] [INFO] huila: sin nuevos registros
[2025-08-14 08:31:50] [INFO] manizales: sin nuevos registros
[2025-08-14 08:31:50] [INFO] quindio: sin nuevos registros
[2025-08-14 08:31:50] [INFO] medellin: sin nuevos registros
[2025-08-14 08:31:50] [INFO] boyaca: sin nuevos registros
[2025-08-14 08:31:50] ✅ Scrapeo completado
[OK  ] Scraper LOTERÃAS  RC=0

[STEP] Scraper ASTRO LUNA
[CMD ] python -X utf8 "C:\RadarPremios\scripts\scraper_astroluna.py"
[2025-08-14 08:31:51] === Inicio de scrapeo de AstroLuna ===
[2025-08-14 08:32:01] [INFO] AstroLuna: sin nuevos registros
[2025-08-14 08:32:01] ✅ Scrapeo completado
[OK  ] Scraper ASTRO LUNA  RC=0

[STEP] Scraper BALOTO premios
[CMD ] python -X utf8 "C:\RadarPremios\scripts\scraper_baloto_premios.py"
[2025-08-14 08:32:01] === Inicio de scrapeo de premios Baloto ===
[2025-08-14 08:32:01] ⏳ Sorteo 2540 -> https://baloto.com/resultados-baloto/2540
[2025-08-14 08:32:02] [REINTENTO 1] Error al acceder https://baloto.com/resultados-baloto/2540: 500 Server Error: Internal Server Error for url: https://baloto.com/resultados-baloto/2540
[2025-08-14 08:32:05] [REINTENTO 2] Error al acceder https://baloto.com/resultados-baloto/2540: 500 Server Error: Internal Server Error for url: https://baloto.com/resultados-baloto/2540
[2025-08-14 08:32:09] [REINTENTO 3] Error al acceder https://baloto.com/resultados-baloto/2540: 500 Server Error: Internal Server Error for url: https://baloto.com/resultados-baloto/2540
[2025-08-14 08:32:09] [ERROR] Fallo permanente al acceder a https://baloto.com/resultados-baloto/2540
[2025-08-14 08:32:09] [INFO] Sin nuevos registros para guardar.
[2025-08-14 08:32:09] ✅ Scrapeo completado
[OK  ] Scraper BALOTO premios  RC=0

[STEP] Scraper BALOTO resultados
[CMD ] python -X utf8 "C:\RadarPremios\scripts\scraper_baloto_resultados.py"
[2025-08-14 08:32:09] === Inicio de scrapeo de Baloto ===
[2025-08-14 08:32:09] ⏳ Sorteo 2540 -> https://www.baloto.com/resultados-baloto/2540
[2025-08-14 08:32:10] [REINTENTO 1] Error al acceder https://www.baloto.com/resultados-baloto/2540: 500 Server Error: Internal Server Error for url: https://www.baloto.com/resultados-baloto/2540
[2025-08-14 08:32:13] [REINTENTO 2] Error al acceder https://www.baloto.com/resultados-baloto/2540: 500 Server Error: Internal Server Error for url: https://www.baloto.com/resultados-baloto/2540
[2025-08-14 08:32:16] [REINTENTO 3] Error al acceder https://www.baloto.com/resultados-baloto/2540: 500 Server Error: Internal Server Error for url: https://www.baloto.com/resultados-baloto/2540
[2025-08-14 08:32:16] [ERROR] Fallo permanente al acceder a https://www.baloto.com/resultados-baloto/2540
[2025-08-14 08:32:16] [INFO] Sin nuevos registros para guardar.
[2025-08-14 08:32:16] ✅ Scrapeo completado
[OK  ] Scraper BALOTO resultados  RC=0

[STEP] Scraper REVANCHA premios
[CMD ] python -X utf8 "C:\RadarPremios\scripts\scraper_revancha_premios.py"
[2025-08-14 08:32:17] === Inicio de scrapeo de premios Revancha ===
[2025-08-14 08:32:17] ⏳ Sorteo 2540 -> https://www.baloto.com/resultados-revancha/2540
[2025-08-14 08:32:18] [REINTENTO 1] Error al acceder https://www.baloto.com/resultados-revancha/2540: 500 Server Error: Internal Server Error for url: https://www.baloto.com/resultados-revancha/2540
[2025-08-14 08:32:21] [REINTENTO 2] Error al acceder https://www.baloto.com/resultados-revancha/2540: 500 Server Error: Internal Server Error for url: https://www.baloto.com/resultados-revancha/2540
[2025-08-14 08:32:25] [REINTENTO 3] Error al acceder https://www.baloto.com/resultados-revancha/2540: 500 Server Error: Internal Server Error for url: https://www.baloto.com/resultados-revancha/2540
[2025-08-14 08:32:25] [ERROR] Fallo permanente al acceder a https://www.baloto.com/resultados-revancha/2540
[2025-08-14 08:32:25] [INFO] Sin nuevos registros para guardar.
[2025-08-14 08:32:25] ✅ Scrapeo completado
[OK  ] Scraper REVANCHA premios  RC=0

[STEP] Scraper REVANCHA resultados
[CMD ] python -X utf8 "C:\RadarPremios\scripts\scraper_revancha_resultados.py"
[2025-08-14 08:32:25] === Inicio de scrapeo de resultados Revancha ===
[2025-08-14 08:32:25] ⏳ Sorteo 2540 -> https://baloto.com/resultados-revancha/2540
[2025-08-14 08:32:26] [REINTENTO 1] Error al acceder https://baloto.com/resultados-revancha/2540: 500 Server Error: Internal Server Error for url: https://baloto.com/resultados-revancha/2540
[2025-08-14 08:32:29] [REINTENTO 2] Error al acceder https://baloto.com/resultados-revancha/2540: 500 Server Error: Internal Server Error for url: https://baloto.com/resultados-revancha/2540
[2025-08-14 08:32:33] [REINTENTO 3] Error al acceder https://baloto.com/resultados-revancha/2540: 500 Server Error: Internal Server Error for url: https://baloto.com/resultados-revancha/2540
[2025-08-14 08:32:33] [ERROR] Fallo permanente al acceder a https://baloto.com/resultados-revancha/2540
[2025-08-14 08:32:33] [INFO] Sin nuevos registros para guardar.
[2025-08-14 08:32:33] ✅ Scrapeo completado
[OK  ] Scraper REVANCHA resultados  RC=0

[STEP] LIMPIAR CSVs
[CMD ] python -X utf8 "C:\RadarPremios\scripts\limpiar_csvs.py"
[INFO] Origen no existe: C:\RadarPremios\data\crudos
[INFO] Nada que limpiar. Saliendo (RC=0).
[OK  ] LIMPIAR CSVs  RC=0

[STEP] CARGAR DB
[CMD ] python -X utf8 "C:\RadarPremios\scripts\cargar_db.py"
📥 Cargando boyaca.csv → tabla boyaca
✅ Tabla boyaca cargada con 102 registros.
📥 Cargando huila.csv → tabla huila
✅ Tabla huila cargada con 101 registros.
📥 Cargando manizales.csv → tabla manizales
✅ Tabla manizales cargada con 101 registros.
📥 Cargando medellin.csv → tabla medellin
✅ Tabla medellin cargada con 101 registros.
📥 Cargando quindio.csv → tabla quindio
✅ Tabla quindio cargada con 101 registros.
📥 Cargando tolima.csv → tabla tolima
✅ Tabla tolima cargada con 102 registros.
📥 Cargando astro_luna.csv → tabla astro_luna
✅ Tabla astro_luna cargada con 5504 registros.
📥 Cargando baloto_resultados.csv → tabla baloto_resultados
✅ Tabla baloto_resultados cargada con 458 registros.
📥 Cargando baloto_premios.csv → tabla baloto_premios
✅ Tabla baloto_premios cargada con 3664 registros.
📥 Cargando revancha_resultados.csv → tabla revancha_resultados
✅ Tabla revancha_resultados cargada con 458 registros.
📥 Cargando revancha_premios.csv → tabla revancha_premios
✅ Tabla revancha_premios cargada con 3664 registros.
📥 Cargando matriz_astro_luna.csv → tabla matriz_astro_luna
✅ Tabla matriz_astro_luna cargada con 5504 registros.

🟢 Base de datos lista en: C:\RadarPremios\radar_premios.db
[OK  ] CARGAR DB  RC=0

[STEP] GENERAR MATRIZ ASTRO LUNA
[CMD ] python -X utf8 "C:\RadarPremios\scripts\generar_matriz_astro_luna.py"
✅ Matriz generada: C:\RadarPremios\data\limpio\matriz_astro_luna.csv
[OK  ] GENERAR MATRIZ ASTRO LUNA  RC=0

[STEP] CARGAR DB post-matriz
[CMD ] python -X utf8 "C:\RadarPremios\scripts\cargar_db.py"
📥 Cargando boyaca.csv → tabla boyaca
✅ Tabla boyaca cargada con 102 registros.
📥 Cargando huila.csv → tabla huila
✅ Tabla huila cargada con 101 registros.
📥 Cargando manizales.csv → tabla manizales
✅ Tabla manizales cargada con 101 registros.
📥 Cargando medellin.csv → tabla medellin
✅ Tabla medellin cargada con 101 registros.
📥 Cargando quindio.csv → tabla quindio
✅ Tabla quindio cargada con 101 registros.
📥 Cargando tolima.csv → tabla tolima
✅ Tabla tolima cargada con 102 registros.
📥 Cargando astro_luna.csv → tabla astro_luna
✅ Tabla astro_luna cargada con 5504 registros.
📥 Cargando baloto_resultados.csv → tabla baloto_resultados
✅ Tabla baloto_resultados cargada con 458 registros.
📥 Cargando baloto_premios.csv → tabla baloto_premios
✅ Tabla baloto_premios cargada con 3664 registros.
📥 Cargando revancha_resultados.csv → tabla revancha_resultados
✅ Tabla revancha_resultados cargada con 458 registros.
📥 Cargando revancha_premios.csv → tabla revancha_premios
✅ Tabla revancha_premios cargada con 3664 registros.
📥 Cargando matriz_astro_luna.csv → tabla matriz_astro_luna
✅ Tabla matriz_astro_luna cargada con 5504 registros.

🟢 Base de datos lista en: C:\RadarPremios\radar_premios.db
[OK  ] CARGAR DB post-matriz  RC=0

[STEP] ACTUALIZAR_BASE_ASTROLUNA
[CMD ] python -X utf8 "C:\RadarPremios\actualizar_base_astroluna.py" --db "C:\RadarPremios\radar_premios.db" --todo-join inner
[OK] Proceso finalizado.
[OK] Log escrito en: C:\RadarPremios\actualizar_base_astroluna_20250814_083236.log.txt
[OK  ] ACTUALIZAR_BASE_ASTROLUNA  RC=0

[STEP] MANTENIMIENTO DB
[CMD ] python -X utf8 "C:\RadarPremios\db_maintenance.py" --db "C:\RadarPremios\radar_premios.db" --todo-join inner
[INFO] db_maintenance.py — 2025-08-14 08:32:36
[INFO] Base: C:\RadarPremios\radar_premios.db
[INFO] Índices asegurados/planificados: 352
[OK] Vista 'todo' creada con INNER JOIN.
[OK] ANALYZE ejecutado.
[OK] VACUUM ejecutado.
[OK] Puesta a punto finalizada.
[OK  ] MANTENIMIENTO DB  RC=0

[STEP] SCORING CANDIDATOS
[CMD ] python -X utf8 "C:\RadarPremios\score_candidates.py" --db "C:\RadarPremios\radar_premios.db" --gen 100 --seed 12345 --top 15 --shortlist 5 --export "C:\RadarPremios\candidatos_scored.csv" --export-all "C:\RadarPremios\candidatos_all.csv" --report "C:\RadarPremios\candidatos_scored.html" --w-hotcold 0.25 --w-cal 0.20 --w-dp 0.20 --w-exact 0.35 --cap-digitpos 60 --cap-exact 180 --cal-horizon 30
TOP 15
2035  score=0.770392  hotcold=0.588  cal=0.700  dp=0.167  exact=1.000  patt=+0.100
0153  score=0.759216  hotcold=0.574  cal=0.700  dp=0.129  exact=1.000  patt=+0.100
6025  score=0.748333  hotcold=0.500  cal=0.700  dp=0.167  exact=1.000  patt=+0.100
0385  score=0.747549  hotcold=0.574  cal=0.700  dp=0.071  exact=1.000  patt=+0.100
8057  score=0.738676  hotcold=0.515  cal=0.700  dp=0.100  exact=1.000  patt=+0.100
6752  score=0.737647  hotcold=0.471  cal=0.600  dp=0.250  exact=1.000  patt=+0.100
5602  score=0.736667  hotcold=0.500  cal=0.700  dp=0.108  exact=1.000  patt=+0.100
2571  score=0.734314  hotcold=0.471  cal=0.600  dp=0.233  exact=1.000  patt=+0.100
5304  score=0.728676  hotcold=0.515  cal=0.700  dp=0.050  exact=1.000  patt=+0.100
7105  score=0.728676  hotcold=0.515  cal=0.700  dp=0.050  exact=1.000  patt=+0.100
2930  score=0.726618  hotcold=0.426  cal=0.700  dp=0.150  exact=1.000  patt=+0.100
6358  score=0.726176  hotcold=0.515  cal=0.600  dp=0.138  exact=1.000  patt=+0.100
7093  score=0.724461  hotcold=0.441  cal=0.700  dp=0.121  exact=1.000  patt=+0.100
0056  score=0.722696  hotcold=0.544  cal=0.800  dp=0.133  exact=1.000  patt=+0.050
9063  score=0.719608  hotcold=0.412  cal=0.700  dp=0.133  exact=1.000  patt=+0.100
[OK] CSV → C:\RadarPremios\candidatos_scored.csv
[OK] CSV (todos) → C:\RadarPremios\candidatos_all.csv
[OK] HTML → C:\RadarPremios\candidatos_scored.html

================================================================
SHORTLIST FINAL (5 propuestas)
----------------------------------------------------------------
  1. 2035  score=0.770392  hotcold=0.588  cal=0.700  dp=0.167  exact=1.000  patt=+0.100
  2. 0153  score=0.759216  hotcold=0.574  cal=0.700  dp=0.129  exact=1.000  patt=+0.100
  3. 6025  score=0.748333  hotcold=0.500  cal=0.700  dp=0.167  exact=1.000  patt=+0.100
  4. 0385  score=0.747549  hotcold=0.574  cal=0.700  dp=0.071  exact=1.000  patt=+0.100
  5. 8057  score=0.738676  hotcold=0.515  cal=0.700  dp=0.100  exact=1.000  patt=+0.100
----------------------------------------------------------------
FOLIO DEL RUN
----------------------------------------------------------------
timestamp: 2025-08-14 08:32:36
db: C:\RadarPremios\radar_premios.db
gen: 100
seed: 12345
top: 15
shortlist: 5
w_hotcold: 0.25
w_cal: 0.2
w_dp: 0.2
w_exact: 0.35
cap_digitpos: 60
cap_exact: 180
export_top: C:\RadarPremios\candidatos_scored.csv
export_all: C:\RadarPremios\candidatos_all.csv
report_html: C:\RadarPremios\candidatos_scored.html
================================================================

[OK] Run guardado en DB con run_id=11
[OK  ] SCORING CANDIDATOS  RC=0

[STEP] EVALUAR RUN RECIENTE
[CMD ] python -X utf8 "C:\RadarPremios\scripts\eval_last_run.py" --db "C:\RadarPremios\radar_premios.db"

==================== VEREDICTO (post-run) ====================
Fecha real más reciente: 2025-08-11
Número ganador:         4968
Run evaluado:           run_id=11  created_at=2025-08-14 13:32:36  seed=12345
Veredicto:              MISS ❌  (rank=—)
==============================================================

[OK  ] EVALUAR RUN RECIENTE  RC=0

=== Master pipeline FINALIZADO ===
[INFO] Log en: C:\RadarPremios\logs\master_2025-08-14_083148.log.txt
